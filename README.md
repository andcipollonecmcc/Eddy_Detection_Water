# Eddy_Detection_Water

## Automatic detection algorithm of active eddies in the ocean 

***Definition**: An "active eddy" is defined as a coherent sea-level anomaly pattern with clockwise/counter-clockwise rotation and a significant environmental anomaly in SST colocalized within such a pattern.*

The eddy detection algorithm used in this work to study the ocean mesoscale field maps relies on the approach proposed by ([Cipollone et al. 2017](https://doi.org/10.1007/s10236-017-1089-5)) for determining the three-dimensional mesoscale field in global ocean reanalysis, and further developed by ([Bonaduce et al. 2021](https://doi.org/10.3389/feart.2021.724879); [2025](https://doi.org/10.3390/rs17040684)) to investigate eddy contributions to ocean dynamics and thermodynamics at the regional scale. In the current study, the method was modified to consider mesoscale eddies at the ocean surface emerging from satellite altimetry maps.  The method consists of a hybrid detection based on both geometrical and dynamical constraints to identify the ocean surface signatures of the same eddy over different variables ([Cipollone et al. 2017](https://doi.org/10.1007/s10236-017-1089-5)). The first component is a geometric identification of local depression/elevation of sea surface height that must be dominated by rotation or by streamlines with circular/spiral patterns ([Xu et al. 2011](https://doi.org/10.1007/s10236-011-0377-8); [Faghmous et al. 2015](https://doi.org/10.1038/sdata.2015.28); [Chelton et al. 2007](https://doi.org/10.1029/2007GL030812)). 

<img width="802" height="199" alt="Cipollone_2017" src="https://github.com/user-attachments/assets/d8f87da4-08e1-4b31-89b0-aba2604f4a8b" />

**Figure 1:** Eddy horizontal extension segmented starting from sea-level anomalies (modified from [Cipollone et al. 2017](https://doi.org/10.1007/s10236-017-1089-5)).

In order to detect eddies inducing anomalies in the sea-surface temperature (SST) field, a further constraint was introduced in the detection algorithm. Following the approach proposed by [Bonaduce et al. 2021](https://doi.org/10.3389/feart.2021.724879) to define anomalies in presence of a non-homogenous backgroup, the calculation of SST anomaly is based on the creation of a background field that mimics a continuous tracer field in the absence of eddy, by replacing it with “surrounding” waters. Each inner point of the eddy is filled with values “extrapolated” from the closest perimetrical points (i.e. Figure 2). 

<img width="1040" height="304" alt="spatial_T_anomaly_v3" src="https://github.com/user-attachments/assets/72a79177-e6d9-47d5-909e-188486ccb653" />

**Figure 2:** Calculation of the eddy-induced SST anomaly. From the left: *original* temperature field with an eddy detected and delimited by its perimeter (black line). Vectors correspond to ocean currents. The parcel of water delimited by the perimeter is masked (*removal*). Temperature values outside the perimeter are extrapolated inside the mask to define the *background* field. The *anomaly* is finally obtained as the difference between the original tracer field and the background. 

The inner (eddy) annulus closest to the eddy perimeter is filled first, each point is replaced with the mean value of the closest ocean points (up to four points) from the eddy perimeter. When the first inner annulus is filled, the algorithm proceeds with the second inner annulus till the eddy center. The background obtained in this case does not have any discontinuity at the eddy perimeter. The anomaly, calculated with respect to such a background field, has a rather robust spatial structure depending on the local boundary values avoiding possible non-local effects coming from temperature values that differ at the other side of the eddy (see  [Bonaduce et al. 2021](https://doi.org/10.3389/feart.2021.724879) for further details). Only mesoscale features showing their signature both in the SLA and SST fields are then retained within the eddy population detected from altimetry maps. The tracking algorithm concatenates the same eddy in consecutive time records (t and t+1) and employs a nearest-neighbor method ([Xu et al. 2011](https://doi.org/10.1007/s10236-011-0377-8); [Faghmous et al. 2015](https://doi.org/10.1038/sdata.2015.28); [Chelton et al. 2007](https://doi.org/10.1029/2007GL030812)). A second tracking procedure between time-step t and t + 2 is implemented to recover eddies that tend to appear and disappear frame by frame. A comprehensive description of the eddy detection and tracking algorithms used in this study is provided by [Cipollone et al. 2017](https://doi.org/10.1007/s10236-017-1089-5) and [Bonaduce et al. 2021](https://doi.org/10.3389/feart.2021.724879), [2025](https://doi.org/10.3390/rs17040684) for global and regional applications, respectively. 


<img width="1040" height="704" alt="SST_ANOMALY_in_NADIR_COMPARE_UNET_NOV" src="https://github.com/user-attachments/assets/21e9d938-edb3-4834-af2d-2e95c672fd98" />

**Figure 3:** SST anomalies (degC) induced by eddies detected from remote-sensing. The panels show the distribution SST anomalies induced by eddy lifetime >7 days.
